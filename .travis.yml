sudo: required
services:
- docker
language: python
python:
- 3.7-dev
env:
  global:
  - DOCKER_COMPOSE_VERSION=1.24.1
before_install:
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname
  -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
jobs:
  include:
  - stage: Tests
    script:
    - docker-compose run --rm app python manage.py test
deploy:
  provider: heroku
  api_key:
    secure: PzcZ5x1YKSv0kZR3pYAI7+KR9ZFKITHYBvTgNfra+/RwiaG9bTMoQuuKLgjRexMABk5FyD57WAbZL5h00l1gvh8ZQDEcIKxQ/Q7PPR7+klcoEOxKeOsmTeampNgT7OPMDu8s2vjoW91y+XVmnCxrFv/Ve7SYIELlJBQmCx4S3b5YzS4gYhcOKrt2Mt32g0PTGw+IjBlBYpKqUjddp2msPDg2RAgsH+tGnMVkHcVcCYgcGMlxK8ayvrF1fZoT0epREQA8Vp1mOX/Pk11tPJc90EW8hTSHfuZXsKDQHK6RQSI9kldRm/yOdxniL+XK2aPUItV7I56NK2T70razbUGFnCByPq3Rpk6nGqjqmyhNIZ62AWZ7dVidUHYKdnGSjigPWNQ0ZzjL3HCE7D2+J8Er/AuWZWHRmICBZmPxwrET3zE+u+rMdj+RVcHz/hxK9NwRuPPCxt7C5fJB6bMBY/Hg7Vz5QmsMsdYEVuG9orwtnw1m6lAla3vsjfz7I3+GsE/TCaail/2P2TcnSiCHYXSCeCZpyvuJ5YLVHKfz1gFjtMl1sgeh+0oD5h0sv7UqMZsx5xPtQKE8PVJ1zR3A02nBx08rL/5BFx+jFCuEewhwbCbHq54c4LUniNj0IQK8fwXtDY6io0IM/wuPaO3mp0CNp8ceTKP+wkzLtVPvnhdfugA=
  on:
    branch: master
after_failure:
- docker-compose logs
